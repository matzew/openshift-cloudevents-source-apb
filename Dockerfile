FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IG9wZW5zaGlmdC1jbG91ZC1ldmVudC1tb25pdG9yLWFwYgpkZXNj\
cmlwdGlvbjogTW9uaXRvciB0aGUgb3BlbnNoaWZ0IHBsYXRmb3JtIGFuZCBlbWl0IENsb3VkIEV2\
ZW50cwpiaW5kYWJsZTogRmFsc2UKYXN5bmM6IG9wdGlvbmFsCm1ldGFkYXRhOgogIGRpc3BsYXlO\
YW1lOiBPcGVuc2hpZnQgQ2xvdWQgRXZlbnQgTW9uaXRvcgogIGltYWdlVXJsOiAiaHR0cHM6Ly9h\
dmF0YXJzMC5naXRodWJ1c2VyY29udGVudC5jb20vdS83OTIzMzc/cz0yMDAmdj00IgpwbGFuczoK\
ICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBUaGlzIGRlcGxveXMgdGhlIE9wZW5z\
aGlmdCBDbG91ZEV2ZW50cyBNb25pdG9yCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToge30K\
ICAgIHBhcmFtZXRlcnM6CiAgICAtIG5hbWU6IGFkbWluX3VzZXIKICAgICAgdGl0bGU6IE9wZW5z\
aGlmdCBBZG1pbiBVc2VyCiAgICAgIHR5cGU6IHN0cmluZwogICAgICByZXF1aXJlZDogdHJ1ZQog\
ICAgLSBuYW1lOiBhZG1pbl9wYXNzd29yZAogICAgICB0aXRsZTogT3BlbnNoaWZ0IEFkbWluIFBh\
c3N3b3JkCiAgICAgIHR5cGU6IHN0cmluZwogICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAg\
ICAgIHJlcXVpcmVkOiB0cnVlCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
